id: sensitive-api

info:
  name: Sensitive API
  author: hithub
  severity: high
  classification:
    cwe-id: CWE-200
  metadata:
    verified: true
  tags: exposure,api,swagger

http:
  - method: GET
    path:
      - "{{BaseURL}}{{paths}}"
    payloads:
      paths:
        - "/api/swagger_doc.json"
        - "/docs"
        - "/dump"
        - "/monitor/jolokia"
        - "/nacos"
        - "/v2.2"
        - "/actuator/loggingConfig"
        - "/monitor/heapdump"
        - "/druid/index.html"
        - "/actuator/heap.hprof.gz"
        - "/actuator/startup"
        - "/env"
        - "/gateway/actuator/env"
        - "/monitor/configprops"
        - "/v1.2/swagger-ui.html"
        - "/v1.3/api-docs"
        - "/actuator/archaius"
        - "/v2.2/api-docs"
        - "/v4.1"
        - "/v1/swagger-resources"
        - "/api/v2/api-docs"
        - "/jolokia"
        - "/logfile"
        - "/v1.6/api-docs"
        - "/v2.1/api-docs"
        - "/api/__swagger__/"
        - "/api/apidocs/swagger.yaml"
        - "/api/v2/swagger-ui.html"
        - "/entity/all"
        - "/actuator/flyway"
        - "/actuator/configurationMetadata"
        - "/actuator/heapdump"
        - "/api/v1/swagger-ui/swagger.json"
        - "/jolokia/list"
        - "/monitor/loggers"
        - "/swagger/swagger-ui.js"
        - "/actuator/auditevents"
        - "/users"
        - "/api-doc"
        - "/api/v2/swagger.json"
        - "/v1.3/swagger-ui.html"
        - "/actuator/trace"
        - "/actuator/registeredServices"
        - "/gateway/actuator/info"
        - "/monitor/httptrace"
        - "/v1.4/swagger-ui.html"
        - "/api/swaggerui"
        - "/api/v2/test/api-docs"
        - "/heap_dump"
        - "/v1.3"
        - "/actuator/heap.hprof"
        - "/api/swagger"
        - "/spring-security-oauth-resource/swagger-ui.html"
        - "/actuator/events"
        - "/api/api-docs/swagger.json"
        - "/apidocs"
        - "/gateway/actuator/logfile"
        - "/monitor/beans"
        - "/swagger-ui/swagger.json"
        - "/swagger/index.html"
        - "/%20/swagger-ui.html/api-docs"
        - "/runningpods/"
        - "/v1.7/api-docs"
        - "/v4.0/swagger-ui.html"
        - "/api/v1/namespaces/kube-system/secrets/"
        - "/system/druid/webseesion.html"
        - "/actuator/exportRegisteredServices"
        - "/api/v1/namespaces/default/pods"
        - "/actuator/integrationgraph"
        - "/gateway/actuator/hystrix.stream"
        - "/swagger-dubbo/api-docs"
        - "/v1.8/swagger-ui.html"
        - "/Swagger/ui/index"
        - "/api/v2/swagger-ui"
        - "/swagger/static/index.html"
        - "/swagger/v1/swagger.json"
        - "/system/druid/index.html"
        - "/v1.7/swagger-ui.html"
        - "/api/api-docs/swagger.yaml"
        - "/api/index.html"
        - "/api/swagger-ui"
        - "/api/v1/swagger-ui.json"
        - "/portal/env"
        - "/swagger-ui"
        - "/api/docs/"
        - "/api/spec/swagger.yaml"
        - "/api/swagger/ui"
        - "/dubbo-provider/distv2/index.html"
        - "/prod-api/actuator"
        - "/actuator/info"
        - "/swagger/swagger-ui.html"
        - "/api/swagger-ui.html"
        - "/api"
        - "/user/swagger-ui.html"
        - "/docu"
        - "/libs/swaggerui"
        - "/api/v1/swagger-ui/swagger.yaml"
        - "/monitor/env"
        - "/sw/swagger-ui.html"
        - "/v1.1"
        - "/webroot/decision/login"
        - "/doc.html"
        - "/api/v1"
        - "/api/v2/swagger"
        - "/swagger/ui"
        - "/scheduledtasks"
        - "/swagger.yml"
        - "/v1.2"
        - "/v1.2/api-docs"
        - "/v1.4/api-docs"
        - "/webpage/system/druid/websession.html"
        - "/actuator/scheduledtasks"
        - "/actuator/swagger-ui.html"
        - "/api/spec/swagger.json"
        - "/doc/"
        - "/druid"
        - "/httptrace"
        - "/info"
        - "/__swagger__/"
        - "/shutdown"
        - "/actuator/jolokia"
        - "/hystrix.stream"
        - "/monitor/conditions"
        - "/swagger-ui.json"
        - "/swagger.yaml"
        - "/v4.3"
        - "/actuator/heapdump.hprof.gz"
        - "/intergrationgraph"
        - "/pods"
        - "/swagger-ui.html"
        - "/gateway/actuator/configprops"
        - "/api/v1/swagger-ui.html"
        - "/decision/login"
        - "/heap"
        - "/v3.1"
        - "/caches"
        - "/v2/swagger-resources"
        - "/api/v3"
        - "/actuator/autoconfig"
        - "/api/swagger-ui/api-docs"
        - "/api/v1/apidocs"
        - "/gateway/actuator/loggers"
        - "/gateway/actuator/scheduledtasks"
        - "/integrationgraph"
        - "/monitor/scheduledtasks"
        - "/actuator/auditevent"
        - "/version"
        - "/druid/websession.html"
        - "/actuator/loggers"
        - "/admin/heapdump"
        - "/api/actuator"
        - "/heap.hprof"
        - "/list"
        - "/login.html"
        - "/actuator/beans"
        - "/autoconfig"
        - "/trace"
        - "/v1.9/api-docs"
        - "/actuator/refresh"
        - "/auditevents"
        - "/conditions"
        - "/spring-security-rest/api/swagger-ui.html"
        - "/trace/"
        - "/api/_swagger_/"
        - "/api/swagger/ui/index"
        - "/apidocs/swagger.json"
        - "/v1.9/swagger-ui.html"
        - "/actuator/nacosconfig"
        - "/actuator/resolveAttributes"
        - "/api-docs"
        - "/api/v2/apidocs"
        - "/v2.1"
        - "/actuator/configprops"
        - "/v2/api-docs"
        - "/v2.2/swagger-ui.html"
        - "/cloudfoundryapplication"
        - "/gateway/actuator/beans"
        - "/gateway/actuator/heapdump"
        - "/heapdump.json"
        - "/v1.6/swagger-ui.html"
        - "/api/swagger-resources/restservices/v2/api-docs"
        - "/api/swagger-resources"
        - "/api/swagger/swagger-ui.html"
        - "/liquibase"
        - "/v1/api-docs"
        - "/v2.3/api-docs"
        - "/api_docs"
        - "/gateway/routes"
        - "/v2.0"
        - "/actuator/httptrace"
        - "/druid/login.html"
        - "/swagger-resources/restservices/v2/api-docs"
        - "/api/v2"
        - "/actuator/heapdump.hprof"
        - "/actuator/liquibase"
        - "/actuator/logfile"
        - "/actuator/nacosdiscovery"
        - "/eureka"
        - "/heap-dump"
        - "/actuator/env"
        - "/monitor/auditevents"
        - "/sessions"
        - "/threaddump"
        - "/v2.0/swagger-ui.html"
        - "/heapdump"
        - "/api/swagger/index.html"
        - "/api/swagger/static/index.html"
        - "/jeecg/swagger"
        - "/swagger/codes"
        - "/uc/env"
        - "/actuator/springWebflow"
        - "/actuator/service-registry"
        - "/actuator/ssoSessions"
        - "/api/doc.json"
        - "/api/swagger-ui/swagger.json"
        - "/swagger/v2/swagger.json"
        - "/_swagger_/"
        - "/v3/api-docs"
        - "/v3.3"
        - "/api/v1/api-docs"
        - "/artemis/api/env"
        - "/gateway/actuator/auditevents"
        - "/gateway/actuator/mappings"
        - "/monitor/threaddump"
        - "/actuator/jolokia/list"
        - "/v2/api-docs?group=violation api"
        - "/v1.5/swagger-ui.html"
        - "/api-docs/swagger.yaml"
        - "/api/swagger.json"
        - "/gateway/actuator/swagger-ui.html"
        - "/mappings"
        - "/monitor/hystrix.stream"
        - "/portal/conf/config.properties"
        - "/actuator/hystrix.stream"
        - "/v2.1/swagger-ui.html"
        - "/gateway/actuator/trace"
        - "/actuator/mappings"
        - "/actuator/sso"
        - "/beans"
        - "/actuator/conditions"
        - "/gateway/actuator/threaddump"
        - "/v2/swagger.json"
        - "/actuator/hd"
        - "/actuator/dump"
        - "/api/doc"
        - "/api/openapi.json"
        - "/openapi.json"
        - "/api/v1/swagger-ui"
        - "/gateway/actuator/conditions"
        - "/gateway/actuator/httptrace"
        - "/gateway/actuator/jolokia"
        - "/actuator/auditLog"
        - "/actuator/caches"
        - "/actuator/sessions"
        - "/api/apidocs/swagger.json"
        - "/swagger-resources"
        - "/swagger/v1/swagger.yaml"
        - "/v2.3/swagger-ui.html"
        - "/%20/swagger-ui.html"
        - "/artemis/api"
        - "/swagger/ui/index"
        - "/actuator/statistics"
        - "/env.css"
        - "/v1.8/api-docs"
        - "/api/docs"
        - "/api/v2/swagger-ui.json"
        - "/configprops"
        - "/distv2/index.html"
        - "/heapdump.hprof"
        - "/monitor/mappings"
        - "/v1.0"
        - "/actuator/;/heapdump"
        - "/jeecg/swagger-ui"
        - "/template/swagger-ui.html"
        - "/v1.1/api-docs"
        - "/v2.0/api-docs"
        - "/v3/test/api-docs"
        - "/actuator/flowable"
        - "/api/swagger-ui/swagger.yaml"
        - "/actuator/status"
        - "/api/swagger.yaml"
        - "/api/v1/swagger.json"
        - "/v2/test/api-docs"
        - "/api-docs/swagger.json"
        - "/heap.hprof.gz"
        - "/loggers"
        - "/v1.5/api-docs"
        - "/api/swagger-ui.json"
        - "/refresh"
        - "/v3.0/swagger-ui.html"
        - "/api/api-docs"
        - "/actuator/threaddump"
        - "/static/swagger.json"
        - "/monitor"
        - "/debug/vars"
        - "/swagger-ui/html"
        - "/v2.3"
        - "/v3/swagger.json"
        - "/v4.2"
        - "/webjars/swagger-ui/index.html"
        - "/api/v1/swagger"
        - "/api/apidocs"
        - "/artemis-portal/artemis/env"
        - "/v3.0"
        - "/v3.2"
        - "/webpage/system/druid/index.html"
        - "/actuator/quartz"
        - "/env/"
        - "/flyway"
        - "/graphql"
        - "/v1.1/swagger-ui.html"
        - "/v3/swagger-resources"
        - "/actuator"
        - "/v4.0"
        - "/actuator/releaseAttributes"
        - "/actuator/shutdown"
        - "/actuator/features"
        - "/api.html"
        - "/heapdump.hprof.gz"
        - "/monitor/info"
        - "/v1.0/swagger-ui.html"
        - "/v1/swagger.json"
        - "/gateway/actuator"
        - "/swagger/doc.json"
        - "/%20swagger-ui.html"
        - "/api/swagger.yml"
        - "/swagger"
        - "/swagger-ui/index.html"
        - "/swagger.json"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "swagger"
          - "Swagger 2.0"
          - "\"swagger\":"
          - "api-docs"
          - "openapi"
          - "etcd"
          - "druid"
          - "api"
          - "Api"
          - "Swagger UI"
          - "swagger"
          - "id=\"swagger-ui"
          - "**token**:"
          - "doc.json"
          - "loadSwaggerUI"
          - "swagger-ui.html"
          - "\"swagger\": \"2.0\""
          - "nacos"
          - "swagger.json"
          - "Size"
          - "size"
          - "doc.json"
          - "api-docs"
          - "openapi.json"
        condition: or