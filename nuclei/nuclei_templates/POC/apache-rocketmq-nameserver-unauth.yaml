id: apache-rocketmq-nameserver-unauth

info:
  name: Apache Rocketmq NameServer - Unauthenticated Access
  author: hithub
  severity: high
  tags: network,rocketmq,broker,apache,unauth,misconfig,tcp
tcp:
  - inputs:
      - data: "000000b6000000b27b22636f6465223a3130362c226578744669656c6473223a7b224163636573734b6579223a22726f636b65746d7132222c225369676e6174757265223a224f7531543538524963795a57615449777a6b684a5a576e2f5a76733d227d2c22666c6167223a302c226c616e6775616765223a224a415641222c226f7061717565223a302c2273657269616c697a655479706543757272656e74525043223a224a534f4e222c2276657273696f6e223a3433337d000000c7000000c37b22636f6465223a3130352c226578744669656c6473223a7b224163636573734b6579223a22726f636b65746d7132222c22746f706963223a22544257313032222c225369676e6174757265223a222f7535502f775a5562686a616e75344c4d2f557a45646f327532493d227d2c22666c6167223a302c226c616e6775616765223a224a415641222c226f7061717565223a312c2273657269616c697a655479706543757272656e74525043223a224a534f4e222c2276657273696f6e223a3433337d"
        type: hex

    host:
      - "{{Hostname}}"
    port: 9876

    matchers:
      - type: word
        words:
          - serializeTypeCurrentRPC
          - language
          - opaque
          - version
        condition: and